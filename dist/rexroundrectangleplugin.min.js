!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rexroundrectangleplugin=e()}(this,(function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}var h=Phaser.Utils.Objects.GetValue,l=function(){function t(n,r,i,o,u){e(this,t),this.cornerRadius={},this._width=0,this._height=0,this.setTo(n,r,i,o,u)}return r(t,[{key:"setTo",value:function(t,e,n,r,i){return this.setPosition(t,e),this.setRadius(i),this.setSize(n,r),this}},{key:"setPosition",value:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}},{key:"setRadius",value:function(t){var e,n;void 0===t&&(t=0),"number"==typeof t?(e=t,n=t):(e=h(t,"x",0),n=h(t,"y",0));var r=this.cornerRadius;return r.tl=f(h(t,"tl",void 0),e,n),r.tr=f(h(t,"tr",void 0),e,n),r.bl=f(h(t,"bl",void 0),e,n),r.br=f(h(t,"br",void 0),e,n),this}},{key:"setSize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"minWidth",get:function(){var t=this.cornerRadius;return Math.max(t.tl.x+t.tr.x,t.bl.x+t.br.x)}},{key:"minHeight",get:function(){var t=this.cornerRadius;return Math.max(t.tl.y+t.bl.y,t.tr.y+t.br.y)}},{key:"width",get:function(){return this._width},set:function(t){null==t&&(t=0),this._width=Math.max(t,this.minWidth)}},{key:"height",get:function(){return this._height},set:function(t){null==t&&(t=0),this._height=Math.max(t,this.minHeight)}},{key:"radius",get:function(){var t=this.cornerRadius;return Math.max(t.tl.x,t.tl.y,t.tr.x,t.tr.y,t.bl.x,t.bl.y,t.br.x,t.br.y)}}]),t}(),f=function(t,e,n){return void 0===t?{x:e,y:n}:"number"==typeof t?{x:t,y:t}:t},x=function(t,e,n){var r=n.length;if(r>=2){var i=n[r-2],o=n[r-1];if(t===i&&e===o)return n}return n.push(t,e),n},c=Math.PI/180,v=function(t){return t*c},y=function(t,e,n,r,i,o,u,a,s){var h,l,f;u&&(o+=360),i=v(i);for(var c=((o=v(o))-i)/a,y=0;y<=a;y++)f=i+c*y,h=t+n*Math.cos(f),l=e+r*Math.sin(f),x(h,l,s);return s},p=d;function d(t,e,n){n=n||2;var r,i,o,u,a,s,h,l=e&&e.length,f=l?e[0]*n:t.length,x=g(t,0,f,n,!0),c=[];if(!x||x.next===x.prev)return c;if(l&&(x=function(t,e,n,r){var i,o,u,a,s,h=[];for(i=0,o=e.length;i<o;i++)u=e[i]*r,a=i<o-1?e[i+1]*r:t.length,(s=g(t,u,a,r,!1))===s.next&&(s.steiner=!0),h.push(j(s));for(h.sort(O),i=0;i<h.length;i++)Z(h[i],n),n=b(n,n.next);return n}(t,e,x,n)),t.length>80*n){r=o=t[0],i=u=t[1];for(var v=n;v<f;v+=n)(a=t[v])<r&&(r=a),(s=t[v+1])<i&&(i=s),a>o&&(o=a),s>u&&(u=s);h=0!==(h=Math.max(o-r,u-i))?1/h:0}return m(x,c,n,r,i,h),c}function g(t,e,n,r,i){var o,u;if(i===Y(t,e,n,r)>0)for(o=e;o<n;o+=r)u=C(o,t[o],t[o+1],u);else for(o=n-r;o>=e;o-=r)u=C(o,t[o],t[o+1],u);return u&&T(u,u.next)&&(F(u),u=u.next),u}function b(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!T(r,r.next)&&0!==D(r.prev,r,r.next))r=r.next;else{if(F(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function m(t,e,n,r,i,o,u){if(t){!u&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=_(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,u,a,s,h=1;do{for(n=t,t=null,o=null,u=0;n;){for(u++,r=n,a=0,e=0;e<h&&(a++,r=r.nextZ);e++);for(s=h;a>0||s>0&&r;)0!==a&&(0===s||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,s--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,h*=2}while(u>1)}(i)}(t,r,i,o);for(var a,s,h=t;t.prev!==t.next;)if(a=t.prev,s=t.next,o?R(t,r,i,o):w(t))e.push(a.i/n),e.push(t.i/n),e.push(s.i/n),F(t),t=s.next,h=s.next;else if((t=s)===h){u?1===u?m(t=k(t,e,n),e,n,r,i,o,2):2===u&&P(t,e,n,r,i,o):m(b(t),e,n,r,i,o,1);break}}}function w(t){var e=t.prev,n=t,r=t.next;if(D(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(S(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&D(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function R(t,e,n,r){var i=t.prev,o=t,u=t.next;if(D(i,o,u)>=0)return!1;for(var a=i.x<o.x?i.x<u.x?i.x:u.x:o.x<u.x?o.x:u.x,s=i.y<o.y?i.y<u.y?i.y:u.y:o.y<u.y?o.y:u.y,h=i.x>o.x?i.x>u.x?i.x:u.x:o.x>u.x?o.x:u.x,l=i.y>o.y?i.y>u.y?i.y:u.y:o.y>u.y?o.y:u.y,f=_(a,s,e,n,r),x=_(h,l,e,n,r),c=t.prevZ,v=t.nextZ;c&&c.z>=f&&v&&v.z<=x;){if(c!==t.prev&&c!==t.next&&S(i.x,i.y,o.x,o.y,u.x,u.y,c.x,c.y)&&D(c.prev,c,c.next)>=0)return!1;if(c=c.prevZ,v!==t.prev&&v!==t.next&&S(i.x,i.y,o.x,o.y,u.x,u.y,v.x,v.y)&&D(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;c&&c.z>=f;){if(c!==t.prev&&c!==t.next&&S(i.x,i.y,o.x,o.y,u.x,u.y,c.x,c.y)&&D(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;v&&v.z<=x;){if(v!==t.prev&&v!==t.next&&S(i.x,i.y,o.x,o.y,u.x,u.y,v.x,v.y)&&D(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function k(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!T(i,o)&&A(i,r,r.next,o)&&z(i,o)&&z(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),F(r),F(r.next),r=t=o),r=r.next}while(r!==t);return r}function P(t,e,n,r,i,o){var u=t;do{for(var a=u.next.next;a!==u.prev;){if(u.i!==a.i&&M(u,a)){var s=G(u,a);return u=b(u,u.next),s=b(s,s.next),m(u,e,n,r,i,o),void m(s,e,n,r,i,o)}a=a.next}u=u.next}while(u!==t)}function O(t,e){return t.x-e.x}function Z(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,u=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>u){if(u=a,a===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===u)return n.prev;var s,h=n,l=n.x,f=n.y,x=1/0;r=n.next;for(;r!==h;)i>=r.x&&r.x>=l&&i!==r.x&&S(o<f?i:u,o,l,f,o<f?u:i,o,r.x,r.y)&&((s=Math.abs(o-r.y)/(i-r.x))<x||s===x&&r.x>n.x)&&z(r,t)&&(n=r,x=s),r=r.next;return n}(t,e)){var n=G(e,t);b(n,n.next)}}function _(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function j(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function S(t,e,n,r,i,o,u,a){return(i-u)*(e-a)-(t-u)*(o-a)>=0&&(t-u)*(r-a)-(n-u)*(e-a)>=0&&(n-u)*(o-a)-(i-u)*(r-a)>=0}function M(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&A(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&z(t,e)&&z(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function D(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function T(t,e){return t.x===e.x&&t.y===e.y}function A(t,e,n,r){return!!(T(t,e)&&T(n,r)||T(t,r)&&T(n,e))||D(t,e,n)>0!=D(t,e,r)>0&&D(n,r,t)>0!=D(n,r,e)>0}function z(t,e){return D(t.prev,t,t.next)<0?D(t,e,t.next)>=0&&D(t,t.prev,e)>=0:D(t,e,t.prev)<0||D(t,t.next,e)<0}function G(t,e){var n=new X(t.i,t.x,t.y),r=new X(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function C(t,e,n,r){var i=new X(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function F(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function X(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Y(t,e,n,r){for(var i=0,o=e,u=n-r;o<n;o+=r)i+=(t[u]-t[o])*(t[o+1]+t[u+1]),u=o;return i}d.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,u=Math.abs(Y(t,0,o,n));if(i)for(var a=0,s=e.length;a<s;a++){var h=e[a]*n,l=a<s-1?e[a+1]*n:t.length;u-=Math.abs(Y(t,h,l,n))}var f=0;for(a=0;a<r.length;a+=3){var x=r[a]*n,c=r[a+1]*n,v=r[a+2]*n;f+=Math.abs((t[x]-t[v])*(t[c+1]-t[x+1])-(t[x]-t[c])*(t[v+1]-t[x+1]))}return 0===u&&0===f?0:Math.abs((f-u)/u)},d.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var u=0;u<e;u++)n.vertices.push(t[i][o][u]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};
/**
   * @author       Richard Davey <rich@photonstorm.com>
   * @copyright    2019 Photon Storm Ltd.
   * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
   */
var W=Phaser.Renderer.WebGL.Utils,I=function(t,e,n,r,i,o){for(var u=W.getTintAppendFloatAlphaAndSwap(n.fillColor,n.fillAlpha*r),a=n.pathData,s=n.pathIndexes,h=0;h<s.length;h+=3){var l=2*s[h],f=2*s[h+1],x=2*s[h+2],c=a[l+0]-i,v=a[l+1]-o,y=a[f+0]-i,p=a[f+1]-o,d=a[x+0]-i,g=a[x+1]-o,b=e.getX(c,v),m=e.getY(c,v),w=e.getX(y,p),R=e.getY(y,p),k=e.getX(d,g),P=e.getY(d,g);t.setTexture2D(),t.batchTri(b,m,w,R,k,P,0,0,1,1,u,u,u,t.tintEffect)}},L=Phaser.Renderer.WebGL.Utils,U=function(t,e,n,r,i){var o=t.strokeTint,u=L.getTintAppendFloatAlphaAndSwap(e.strokeColor,e.strokeAlpha*n);o.TL=u,o.TR=u,o.BL=u,o.BR=u;var a=e.pathData,s=a.length-1,h=e.lineWidth,l=h/2,f=a[0]-r,x=a[1]-i;e.closePath||(s-=2);for(var c=2;c<s;c+=2){var v=a[c]-r,y=a[c+1]-i;t.setTexture2D(),t.batchLine(f,x,v,y,l,l,h,c-2,!!e.closePath&&c===s-1),f=v,x=y}},B=function(t,e,n,r,i){var o=this.pipeline,u=o._tempMatrix1,a=o._tempMatrix2,s=o._tempMatrix3;t.setPipeline(o),a.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),u.copyFrom(r.matrix),i?(u.multiplyWithOffset(i,-r.scrollX*e.scrollFactorX,-r.scrollY*e.scrollFactorY),a.e=e.x,a.f=e.y):(a.e-=r.scrollX*e.scrollFactorX,a.f-=r.scrollY*e.scrollFactorY),u.multiply(a,s);var h=e._displayOriginX,l=e._displayOriginY,f=r.alpha*e.alpha;e.isFilled&&I(o,s,e,f,h,l),e.isStroked&&U(o,e,f,h,l)},E=function(t,e,n,r){var i=n||e.fillColor,o=r||e.fillAlpha,u=(16711680&i)>>>16,a=(65280&i)>>>8,s=255&i;t.fillStyle="rgba("+u+","+a+","+s+","+o+")"},V=function(t,e,n,r){var i=n||e.strokeColor,o=r||e.strokeAlpha,u=(16711680&i)>>>16,a=(65280&i)>>>8,s=255&i;t.strokeStyle="rgba("+u+","+a+","+s+","+o+")",t.lineWidth=e.lineWidth},H=Phaser.Renderer.Canvas.SetTransform,q={renderWebGL:B,renderCanvas:function(t,e,n,r,i){var o=t.currentContext;if(H(t,o,e,r,i)){var u=e._displayOriginX,a=e._displayOriginY,s=e.pathData,h=s.length-1,l=s[0]-u,f=s[1]-a;o.beginPath(),o.moveTo(l,f),e.closePath||(h-=2);for(var x=2;x<h;x+=2){var c=s[x]-u,v=s[x+1]-a;o.lineTo(c,v)}o.closePath(),e.isFilled&&(E(o,e),o.fill()),e.isStroked&&(V(o,e),o.stroke()),o.restore()}}},J=Phaser.Utils.Objects.GetValue,K=function(t){i(o,Phaser.GameObjects.Shape);var n=s(o);function o(t,r,i,u,a,s,h,f){var x;e(this,o),void 0===r&&(r=0),void 0===i&&(i=0);var c=J(s,"iteration",void 0);s=J(s,"radius",s);var v=new l(0,0,u,a,s);return(x=n.call(this,t,"RoundRectangle",v)).setIteration(c),x.setPosition(r,i),void 0!==h&&x.setFillStyle(h,f),x.updateDisplayOrigin(),x.updateData(),x}return r(o,[{key:"updateData",value:function(){var t=this.geom,e=this.pathData;e.length=0;var n,r=t.cornerRadius,i=this.iteration+1;if(n=r.br,N(n)){var o=t.width-n.x,u=t.height-n.y;y(o,u,n.x,n.y,0,90,!1,i,e)}else x(t.width,t.height,e);if(n=r.bl,N(n)){o=n.x,u=t.height-n.y;y(o,u,n.x,n.y,90,180,!1,i,e)}else x(0,t.height,e);if(n=r.tl,N(n)){o=n.x,u=n.y;y(o,u,n.x,n.y,180,270,!1,i,e)}else x(0,0,e);if(n=r.tr,N(n)){o=t.width-n.x,u=n.y;y(o,u,n.x,n.y,270,360,!1,i,e)}else x(t.width,0,e);return e.push(e[0],e[1]),this.pathIndexes=p(e),this}},{key:"resize",value:function(t,e){if(void 0===e&&(e=t),this.geom.width===t&&this.geom.height===e)return this;this.geom.height=e,this.geom.width=t,this.updateDisplayOrigin(),this.updateData();var n=this.input;return n&&!n.customHitArea&&(n.hitArea.width=t,n.hitArea.height=e),this}},{key:"setIteration",value:function(t){return void 0===t&&(t=6),this.iteration=t,this}},{key:"setRadius",value:function(t){return void 0===t&&(t=0),this.radius=t,this}},{key:"setCornerRadius",value:function(t){return this.setRadius(t)}},{key:"width",get:function(){return this.geom.width},set:function(t){this.resize(t,this.height)}},{key:"height",get:function(){return this.geom.height},set:function(t){this.resize(this.width,t)}},{key:"iteration",get:function(){return this._iteration},set:function(t){void 0!==this._iteration?this._iteration!==t&&(this._iteration=t,this.updateData()):this._iteration=t}},{key:"radius",get:function(){return this.geom.radius},set:function(t){this.geom.setRadius(t),this.updateDisplayOrigin(),this.updateData()}},{key:"cornerRadius",get:function(){return this.geom.cornerRadius},set:function(t){this.radius=t}}]),o}(),N=function(t){return 0!==t.x&&0!==t.y};function Q(t,e,n,r,i,o,u){var a=new K(this.scene,t,e,n,r,i,o,u);return this.scene.add.existing(a),a}Object.assign(K.prototype,q);var $=Phaser.Utils.Objects.GetAdvancedValue,tt=Phaser.Utils.Objects.GetValue,et=Phaser.GameObjects.BuildGameObject;function nt(t){var e=$(t,"width",void 0),n=$(t,"height",e),r=tt(t,"radius",void 0),i=$(t,"fillColor",void 0),o=$(t,"fillAlpha",void 0),u=new K(this.scene,0,0,e,n,r,i,o);return et(this.scene,u,t),u}var rt=function(t){return null==t||""===t||0===t.length},it=function(t){i(o,Phaser.Plugins.BasePlugin);var n=s(o);function o(t){var r;return e(this,o),r=n.call(this,t),t.registerGameObject("rexRoundRectangle",Q,nt),r}return r(o,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}}]),o}();return function(e,n,r){if("object"===t(e)){if(rt(n)){if(null==r)return;"object"===t(r)&&(e=r)}else{"string"==typeof n&&(n=n.split("."));var i=n.pop();(function(e,n,r){var i=e;if(rt(n));else{var o;"string"==typeof n&&(n=n.split("."));for(var u=0,a=n.length;u<a;u++){var s;if(null==i[o=n[u]]||"object"!==t(i[o]))s=u===a-1?void 0===r?{}:r:{},i[o]=s;i=i[o]}}return i}(e,n))[i]=r}}}(window,"RexPlugins.GameObjects.RoundRectangle",K),it}));
