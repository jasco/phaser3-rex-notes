!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rexninepatch=e()}(this,(function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function e(t){return(e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function n(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=e(t);if(r){var s=e(this).constructor;n=Reflect.construct(o,arguments,s)}else n=o.apply(this,arguments);return i(this,n)}}function o(t,r,i){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,r,i){var n=function(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=e(t)););return t}(t,r);if(n){var o=Object.getOwnPropertyDescriptor(n,r);return o.get?o.get.call(i):o.value}})(t,r,i||t)}var s=function(t){return"[object Array]"===Object.prototype.toString.call(t)},c=function(t,e,r){return void 0===r&&(r="image"),t[e]||(t[e]=t.scene.make[r]({add:!1,origin:{x:0,y:0}}),t.on("destroy",(function(){t[e]&&(t[e].destroy(),t[e]=void 0)}))),t[e]},h=Phaser.Utils.Objects.IsPlainObject,u=Phaser.Utils.Objects.GetValue,a=function(t){return"string"==typeof t&&(t=l[t]),t},l={scale:0,repeat:1},f=function(t,e){return 0===t||t===this.columns.count-1||0===e||e===this.rows.count-1},d={setTexture:function(t,e,r,i){s(e)&&(i=r,r=e,e=void 0),void 0===e&&(e="__BASE"),this.textureKey=t,this.baseFrameName=e,this.columns.data=r,this.columns.count=r?r.length:0,this.columns.stretch=0,this.columns.minWidth=0,this.rows.data=i,this.rows.count=i?i.length:0,this.rows.stretch=0,this.rows.minHeight=0;var n=this.scene.textures.get(t);if(!n)return this.clear(),this;if(!r||!i)return this.clear(),this;for(var o=n.frames[e],c=o.width,h=0,u=0,a=r.length;u<a;u++)void 0===r[u]?h++:"number"==typeof r[u]?c-=r[u]:c-=r[u].width;var l=c/h,f=o.height,d=0;for(u=0,a=i.length;u<a;u++)void 0===i[u]?d++:"number"==typeof i[u]?f-=i[u]:f-=i[u].width;for(var m,v,p,g,y,b=f/d,w=0,O=0,x=0,j=i.length;x<j;x++){void 0===i[x]&&(i[x]=b),"number"==typeof i[x]&&(i[x]={height:i[x],stretch:x%2}),p=(m=i[x]).height,this.rows.stretch+=0|m.stretch,this.rows.minHeight+=m.stretch>0?0:p,w=0;u=0;for(var _=r.length;u<_;u++)void 0===r[u]&&(r[u]=l),"number"==typeof r[u]&&(r[u]={width:r[u],stretch:u%2}),g=(v=r[u]).width,0===x&&(this.columns.stretch+=0|v.stretch,this.columns.minWidth+=v.stretch>0?0:g),g>=1&&p>=1?(y=this.getFrameNameCallback(u,x,e))&&n.add(y,0,w+o.cutX,O+o.cutY,g,p):console.warn("Size of Grid(".concat(u,",").concat(x,") = ").concat(g,"x").concat(p,", which is invalid")),w+=g;O+=p}return this.updateTexture(),this},updateTexture:function(){if(this.clear(),void 0===this.textureKey)return this;var t=this.scene.textures.get(this.textureKey);if(!t)return this;var e,r,i=this.width-this.columns.minWidth;i>=0?(e=this.columns.stretch>0?i/this.columns.stretch:0,r=1):(e=0,r=this.width/this.columns.minWidth);var n,o,s,h,u,a,l,f=this.height-this.rows.minHeight;f>=0?(n=this.rows.stretch>0?f/this.rows.stretch:0,o=1):(n=0,o=this.height/this.rows.minHeight);for(var d,m=0,v=0,p=0,g=this.rows.count;p<g;p++){l=0===(u=this.rows.data[p]).stretch?u.height*o:n*u.stretch,m=0;for(var y=0,b=this.columns.count;y<b;y++)a=0===(h=this.columns.data[y]).stretch?h.width*r:e*h.stretch,(s=this.getFrameNameCallback(y,p,this.baseFrameName))&&a>0&&l>0&&t.has(s)&&(0===(0===u.stretch&&0===h.stretch||0===this.getStretchMode(y,p)?0:1)?(d=c(this,"_image","image")).setTexture(this.textureKey,s).setDisplaySize(a,l):(d=c(this,"_tileSprite","tileSprite")).setTexture(this.textureKey,s).setSize(a,l)),d&&(this.draw(d,m,v),d=void 0),m+=a;v+=l}},setStretchMode:function(t){return h(t)?(this.stretchMode.edge=a(u(t,"edge",0)),this.stretchMode.internal=a(u(t,"internal",0))):(t=a(t),this.stretchMode.edge=t,this.stretchMode.internal=t),this},getStretchMode:function(t,e){return f.call(this,t,e)?this.stretchMode.edge:this.stretchMode.internal}},m=function(t,e,r){return"__BASE"===r?"".concat(t,",").concat(e):"".concat(r,"_").concat(t,",").concat(e)},v=Phaser.GameObjects.RenderTexture,p=Phaser.Utils.Objects.IsPlainObject,g=Phaser.Utils.Objects.GetValue,y=function(i){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(l,i);var c,h,u,a=n(l);function l(t,e,r,i,n,o,c,h,u,f){var d;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),p(e)?(e=g(f=e,"x",0),r=g(f,"y",0),i=g(f,"width",1),n=g(f,"height",1),o=g(f,"key",void 0),c=g(f,"baseFrame",void 0),h=g(f,"columns",void 0),u=g(f,"rows",void 0)):p(i)?(i=g(f=i,"width",1),n=g(f,"height",1),o=g(f,"key",void 0),c=g(f,"baseFrame",void 0),h=g(f,"columns",void 0),u=g(f,"rows",void 0)):p(o)?(o=g(f=o,"key",void 0),c=g(f,"baseFrame",void 0),h=g(f,"columns",void 0),u=g(f,"rows",void 0)):p(c)?(c=g(f=c,"baseFrame",void 0),h=g(f,"columns",void 0),u=g(f,"rows",void 0)):s(c)?(f=u,u=h,h=c,c=g(f,"baseFrame",void 0)):p(h)&&(h=g(f=h,"columns",void 0),u=g(f,"rows",void 0)),(d=a.call(this,t,e,r,i,n)).columns={},d.rows={},d.stretchMode={},d._tileSprite=void 0,d._image=void 0,d.setOrigin(.5,.5),d.setGetFrameNameCallback(g(f,"getFrameNameCallback",void 0)),d.setStretchMode(g(f,"stretchMode",0)),d.setTexture(o,c,h,u),d}return c=l,(h=[{key:"setGetFrameNameCallback",value:function(t){return void 0===t&&(t=m),this.getFrameNameCallback=t,this}},{key:"resize",value:function(t,r){return this.width===t&&this.height===r||(o(e(l.prototype),"resize",this).call(this,t,r),this.updateTexture()),this}},{key:"minWidth",get:function(){return this.columns.minWidth}},{key:"minHeight",get:function(){return this.rows.minHeight}}])&&t(c.prototype,h),u&&t(c,u),l}(v);return Object.assign(y.prototype,d),y}));
