!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rexgridalignplugin=e()}(this,(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=n(t);if(e){var s=n(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return o(this,i)}}var h=Math.sqrt(3),u=Math.sqrt(3),c=0,f=1,a=2,l=3,d=c,g=f,y=a,v=l,p={},x=c,b=f,w=a,k=l,O={},_={},W=c,X=f,Y=a,m=l,z={},P={},T=function(t,e,i){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1!==e.indexOf(".")){for(var n=e.split("."),r=t,o=i,s=0;s<n.length;s++){if(!r.hasOwnProperty(n[s])){o=i;break}o=r[n[s]],r=r[n[s]]}return o}return i}return i},M=c,S=f,H=a,j=l,C=function(){function e(i){t(this,e),this.resetFromJSON(i)}return i(e,[{key:"resetFromJSON",value:function(t){if(this.setType(T(t,"staggeraxis",1),T(t,"staggerindex",1)),this.setDirectionMode(),this.setOriginPosition(T(t,"x",0),T(t,"y",0)),this.size=T(t,"size",void 0),void 0!==this.size){var e={size:this.size,type:this.staggeraxis},i=function(t){return 0===t.type?2*t.size:h*t.size}(e),n=function(t){return 0===t.type?u*t.size:2*t.size}(e);this.setCellSize(i,n)}else this.setCellSize(T(t,"cellWidth",0),T(t,"cellHeight",0))}},{key:"setType",value:function(t,e){return"string"==typeof t&&(t=R[t]),"string"==typeof e&&(e=E[e]),this.staggeraxis=t,this.staggerindex=e,this.mode=0===t?0===e?j:H:0===e?S:M,this}},{key:"setDirectionMode",value:function(){return this.directions=6,this}},{key:"setOriginPosition",value:function(t,e){return this.x=t,this.y=e,this}},{key:"setCellSize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._halfWidth=t/2}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._halfHeight=t/2}},{key:"cellWidth",get:function(){return this.width},set:function(t){this.width=t}},{key:"cellHeight",get:function(){return this.height}},{key:"cellHieght",set:function(t){this.height=t}}]),e}(),D={getWorldXY:function(t,e,i){void 0===i?i={}:!0===i&&(i=p);var n=t*this.width,r=e*this.height;switch(this.mode){case d:1&e&&(n+=this._halfWidth),r*=.75;break;case g:1&e&&(n-=this._halfWidth),r*=.75;break;case y:n*=.75,1&t&&(r+=this._halfHeight);break;case v:n*=.75,1&t&&(r-=this._halfHeight)}return n+=this.x,r+=this.y,i.x=n,i.y=r,i},getWorldX:function(t,e){return this.getWorldXY(t,e,!0).x},getWorldY:function(t,e){return this.getWorldXY(t,e,!0).y},getTileXY:function(t,e,i){var n,r;switch(void 0===i?i={}:!0===i&&(i=P),t-=this.x,e-=this.y,this.mode){case W:case X:r=e*(4/3)/this.height,n=t/this.width-2/3*(e/this.height);break;case Y:case m:r=e/this.height-2/3*(t/this.width),n=t*(4/3)/this.width}var o=function(t,e,i){return void 0===i?i={}:!0===i&&(i=O),i.x=t,i.y=-t-e,i.z=e,i}(n,r,z);return function(t,e,i,n){"number"!=typeof t&&(t=(n=t).x,e=n.y,i=n.z),void 0===n?n={}:!0===n&&(n=O);var r=Math.round(t),o=Math.round(e),s=Math.round(i),h=Math.abs(r-t),u=Math.abs(o-e),c=Math.abs(s-i);h>u&&h>c?r=-o-s:u>c?o=-r-s:s=-r-o,n.x=r,n.y=o,n.z=s}(o),function(t,e,i,n,r){switch(void 0===r?r={}:!0===r&&(r=_),t){case x:r.x=e+(n-(1&n))/2,r.y=n;break;case b:r.x=e+(n+(1&n))/2,r.y=n;break;case w:r.x=e,r.y=n+(e-(1&e))/2;break;case k:r.x=e,r.y=n+(e+(1&e))/2}}(this.mode,o.x,o.y,o.z,i),i},getTileX:function(t,e){return this.getTileXY(t,e,!0).x},getTileY:function(t,e){return this.getTileXY(t,e,!0).y}};Object.assign(C.prototype,D);var R={y:0,x:1},E={even:0,odd:1},F=function(){},N=new Phaser.GameObjects.Zone({sys:{queueDepthSort:F,events:{once:F}}},0,0,1,1);N.setOrigin(0);var q=0,J=1,G=2,A=4,U=6,V=8,B=10,Z=12,I=function(t){return void 0!==t.displayWidth?t.displayWidth:t.width},K=function(t){return void 0!==t.displayHeight?t.displayHeight:t.height},L=function(t){var e=K(t);return t.y+e-e*t.originY},Q=function(t){var e=I(t);return t.x-e*t.originX+.5*e},$=function(t,e){var i=K(t);return t.y=e-i+i*t.originY,t},tt=function(t,e){var i=I(t),n=i*t.originX;return t.x=e+n-.5*i,t},et=function(t){var e=I(t);return t.x-e*t.originX},it=function(t,e){var i=I(t);return t.x=e+i*t.originX,t},nt=function(t){var e=I(t);return t.x+e-e*t.originX},rt=function(t,e){var i=I(t);return t.x=e-i+i*t.originX,t},ot=function(t,e){var i=K(t),n=i*t.originY;return t.y=e+n-.5*i,t},st=function(t){var e=K(t);return t.y-e*t.originY+.5*e},ht=function(t){var e=K(t);return t.y-e*t.originY},ut=function(t,e){var i=K(t);return t.y=e+i*t.originY,t},ct=[];ct[11]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),tt(t,Q(e)+i),$(t,L(e)+n),t},ct[B]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),it(t,et(e)-i),$(t,L(e)+n),t},ct[Z]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),rt(t,nt(e)+i),$(t,L(e)+n),t},ct[U]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),function(t,e,i){tt(t,e),ot(t,i)}(t,Q(e)+i,st(e)+n),t},ct[A]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),it(t,et(e)-i),ot(t,st(e)+n),t},ct[V]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),rt(t,nt(e)+i),ot(t,st(e)+n),t},ct[J]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),tt(t,Q(e)+i),ut(t,ht(e)-n),t},ct[q]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),it(t,et(e)-i),ut(t,ht(e)-n),t},ct[G]=function(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),rt(t,nt(e)+i),ut(t,ht(e)-n),t};var ft=function(t,e,i,n,r){return ct[i](t,e,n,r)},at=Phaser.Utils.Objects.GetFastValue,lt=new C,dt={},gt={},yt=function(){function e(i){t(this,e),this.resetFromJSON(i)}return i(e,[{key:"resetFromJSON",value:function(t){this.setType(T(t,"type",0)),this.setDirectionMode(T(t,"dir",4)),this.setOriginPosition(T(t,"x",0),T(t,"y",0)),this.setCellSize(T(t,"cellWidth",0),T(t,"cellHeight",0))}},{key:"setType",value:function(t){return"string"==typeof t&&(t=pt[t]),this.mode=t,this}},{key:"setDirectionMode",value:function(t){return"string"==typeof t&&(t=xt[t]),this.directions=t,this}},{key:"setOriginPosition",value:function(t,e){return this.x=t,this.y=e,this}},{key:"setCellSize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._halfWidth=t/2}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._halfHeight=t/2}},{key:"cellWidth",get:function(){return this.width},set:function(t){this.width=t}},{key:"cellHeight",get:function(){return this.height}},{key:"cellHieght",set:function(t){this.height=t}}]),e}(),vt={getWorldXY:function(t,e,i){var n,r;switch(void 0===i?i={}:!0===i&&(i=dt),this.mode){case 0:n=t*this.width,r=e*this.height;break;case 1:n=(t-e)*this._halfWidth,r=(t+e)*this._halfHeight}return n+=this.x,r+=this.y,i.x=n,i.y=r,i},getWorldX:function(t,e){return this.getWorldXY(t,e,!0).x},getWorldY:function(t,e){return this.getWorldXY(t,e,!0).y},getTileXY:function(t,e,i){void 0===i?i={}:!0===i&&(i=gt),t-=this.x,e-=this.y;var n=t/this.width,r=e/this.height;switch(this.mode){case 0:i.x=Math.round(n),i.y=Math.round(r);break;case 1:i.x=Math.round(+n+r),i.y=Math.round(-n+r)}return i},getTileX:function(t,e){return this.getTileXY(t,e,!0).x},getTileY:function(t,e){return this.getTileXY(t,e,!0).y}};Object.assign(yt.prototype,vt);var pt={orthogonal:0,isometric:1,staggered:2},xt={"4dir":4,"8dir":8},bt=Phaser.Utils.Objects.GetFastValue,wt=new yt;return function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(o,Phaser.Plugins.BasePlugin);var n=s(o);function o(e){return t(this,o),n.call(this,e)}return i(o,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"hexagon",value:function(t,e){return function(t,e){void 0===e&&(e={});var i=at(e,"width",-1),n=at(e,"height",-1),r=at(e,"cellWidth",1),o=at(e,"cellHeight",r),s=at(e,"staggeraxis",1),h=at(e,"staggerindex",1),u=at(e,"position",Phaser.Display.Align.CENTER),c=at(e,"x",0),f=at(e,"y",0);lt.setOriginPosition(c,f).setCellSize(r,o).setType(s,h),N.setSize(r,o);for(var a=n-1,l=i-1,d=0,g=0,y=0,v=t.length;y<v;y++)if(lt.getWorldXY(g,d,N),ft(t[y],N,u),-1===i)d++;else if(-1===n)g++;else if(g===l){if(d===a)break;g=0,d++}else g++;return t}(t,e)}},{key:"quad",value:function(t,e){return function(t,e){void 0===e&&(e={});var i=bt(e,"width",-1),n=bt(e,"height",-1),r=bt(e,"cellWidth",1),o=bt(e,"cellHeight",r),s=bt(e,"type",0),h=bt(e,"position",Phaser.Display.Align.CENTER),u=bt(e,"x",0),c=bt(e,"y",0);wt.setOriginPosition(u,c).setCellSize(r,o).setType(s),N.setSize(r,o);for(var f=n-1,a=i-1,l=0,d=0,g=0,y=t.length;g<y;g++)if(wt.getWorldXY(d,l,N),ft(t[g],N,h),-1===i)l++;else if(-1===n)d++;else if(d===a){if(l===f)break;d=0,l++}else d++;return t}(t,e)}}]),o}()}));
