!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rexbuffdataplugin=e()}(this,(function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function s(t,e,s){return e&&n(t.prototype,e),s&&n(t,s),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?o(t):e}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,s=u(t);if(e){var i=u(this).constructor;n=Reflect.construct(s,arguments,i)}else n=s.apply(this,arguments);return f(this,n)}}var h=function(){function n(){e(this,n),this.buffs={}}return s(n,[{key:"setEnable",value:function(t,e){return void 0===e&&(e=!0),this.buffs.hasOwnProperty(t)||(this.buffs[t]={enable:!0,value:0,type:c}),this.buffs[t].enable=e,this}},{key:"set",value:function(e,n){this.setEnable(e);var s=t(n);"number"===s?s=c:"string"===s&&(-1!==n.indexOf("%")?(s=l,n=parseFloat(n)/100):(s=c,n=parseFloat(n)));var i=this.buffs[e];return i.value=n,i.type=s,this}},{key:"remove",value:function(t){return this.buffs.hasOwnProperty(t)&&delete this.buffs[t],this}},{key:"buff",value:function(t){var e,n,s=t,i=this.buffs;for(var u in i)if((e=i[u]).enable)switch(n=e.type,e=e.value,n){case c:s+=e;break;case l:s+=t*e}return s}}]),n}(),c=0,l=1,b=Phaser.Utils.Objects.IsPlainObject,y=Phaser.Utils.Objects.GetValue,p=function(){function t(n,s){if(e(this,t),b(n)){var i=n;n=y(i,"min",void 0),s=y(i,"max",void 0)}this.setMin(n),this.setMax(s)}return s(t,[{key:"setMin",value:function(t){return this.min=t,this}},{key:"setMax",value:function(t){return this.max=t,this}},{key:"clamp",value:function(t){return void 0!==this.min&&t<this.min?t=this.min:void 0!==this.max&&t>this.max&&(t=this.max),t}}]),t}(),d={setBaseValue:function(t,e){return this.baseValues[t]=e,this.set(t,this.getBuffResult(t)),this},removeBaseValue:function(t){return this.baseValues.hasOwnProperty(t)&&(delete this.baseValues[t],this.remove(t)),this},setBuff:function(t,e,n){return this.buffs.hasOwnProperty(t)||(this.buffs[t]=new h),this.buffs[t].set(e,n),this.set(t,this.getBuffResult(t)),this},enableBuff:function(t,e,n){return this.buffs.hasOwnProperty(t)||(this.buffs[t]=new h),this.buffs[t].setEnable(e,n),this.set(t,this.getBuffResult(t)),this},removeBuff:function(t,e){return this.buffs.hasOwnProperty(t)&&(void 0===e?delete this.buffs[t]:this.buffs[t].remove(e)),this.set(t,this.getBuffResult(t)),this},setMin:function(t,e){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new p),this.bounds[t].setMin(e),this.set(t,this.getBuffResult(t)),this},setMax:function(t,e){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new p),this.bounds[t].setMax(e),this.set(t,this.getBuffResult(t)),this},setBounds:function(t,e,n){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new p),this.bounds[t].setMin(e).setMax(n),this.set(t,this.getBuffResult(t)),this},getBuffResult:function(t){return this.clamp(t,this.buff(t))},buff:function(t,e){return void 0===e&&(e=this.getBaseValue(t)),this.buffs.hasOwnProperty(t)?this.buffs[t].buff(e):e},clamp:function(t,e){return void 0===e&&(e=this.list[t]),this.bounds.hasOwnProperty(t)?this.bounds[t].clamp(e):e},getBaseValue:function(t){return this.baseValues.hasOwnProperty(t)||(this.baseValues[t]=0),this.baseValues[t]},getBuffs:function(t,e){var n=this.buffs[t];return void 0===e?n:n&&n.hasOwnProperty(e)?n[e]:void 0},getBounds:function(t){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new p),this.bounds[t]}},v=function(t){return void 0===t.buffs&&(t.baseValues={},t.buffs={},t.bounds={}),void 0===t.addBuff&&Object.assign(t,d),t},m=Phaser.Data.DataManager,w=Phaser.Events.EventEmitter,O=function(t){i(s,t);var n=a(s);function s(t,i){var u;return e(this,s),void 0===i&&(i=new w),u=n.call(this,t,i),v(o(u)),u}return s}(m);return Object.assign(O.prototype,d),function(t){i(u,Phaser.Plugins.BasePlugin);var n=a(u);function u(t){return e(this,u),n.call(this,t)}return s(u,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(t,e){return new O(t,e)}},{key:"extend",value:function(t){return v(t)}}]),u}()}));
