!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rexawaytimeplugin=e()}(this,(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=r(t);if(e){var u=r(this).constructor;n=Reflect.construct(i,arguments,u)}else n=i.apply(this,arguments);return o(this,n)}}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}var a=Phaser.Utils.Objects.GetValue,c=function(){function e(n){t(this,e),this.state=f,this.setKey(a(n,"key","away")),this.setPeriod(a(n,"period",1e3))}return n(e,[{key:"destroy",value:function(){this.stop()}},{key:"start",value:function(){return this.stop(),this.updateTime(),this.timer=setInterval(this.updateTime.bind(this),this.period),this.state=l,this}},{key:"stop",value:function(){return this.state===f||(clearTimeout(this.timer),this.timer=void 0,this.state=f),this}},{key:"updateTime",value:function(){return localStorage.setItem(this.key,this.curTime),this}},{key:"setKey",value:function(t){return this.key=t,this}},{key:"setPeriod",value:function(t){return this.period=t,this}},{key:"awayTime",get:function(){var t=localStorage.getItem(this.key);if(this.start(),null==t)return 0;t=parseInt(t);var e=this.curTime;return t<0||t>e?0:e-t}},{key:"curTime",get:function(){return(new Date).getTime()}}]),e}(),f=0,l=1;return function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(a,Phaser.Plugins.BasePlugin);var o=u(a);function a(e){return t(this,a),o.call(this,e)}return n(a,[{key:"start",value:function(){this._awayTime=this.add(),this.game.events.on("destroy",this.destroy,this)}},{key:"destroy",value:function(){this._awayTime.destroy(),s(r(a.prototype),"destroy",this).call(this)}},{key:"add",value:function(t){return new c(t)}},{key:"setKey",value:function(t){return this._awayTime.setKey(t),this}},{key:"setPeriod",value:function(t){return this._awayTime.setPeriod(t),this}},{key:"awayTime",get:function(){return this._awayTime.awayTime}}]),a}()}));
