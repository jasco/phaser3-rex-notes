!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).rexlzstringplugin=t()}(this,(function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=r(e);if(t){var s=r(this).constructor;n=Reflect.construct(o,arguments,s)}else n=o.apply(this,arguments);return i(this,n)}}var u=function(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}((function(e){var t=function(){function e(e,t){if(!o[e]){o[e]={};for(var n=0;n<e.length;n++)o[e][e.charAt(n)]=n}return o[e][t]}var t=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={},i={compressToBase64:function(e){if(null==e)return"";var t=i._compress(e,6,(function(e){return n.charAt(e)}));switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:i._decompress(t.length,32,(function(r){return e(n,t.charAt(r))}))},compressToUTF16:function(e){return null==e?"":i._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:i._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=i.compress(e),n=new Uint8Array(2*t.length),r=0,o=t.length;o>r;r++){var s=t.charCodeAt(r);n[2*r]=s>>>8,n[2*r+1]=s%256}return n},decompressFromUint8Array:function(e){if(null==e)return i.decompress(e);for(var n=new Array(e.length/2),r=0,o=n.length;o>r;r++)n[r]=256*e[2*r]+e[2*r+1];var s=[];return n.forEach((function(e){s.push(t(e))})),i.decompress(s.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":i._compress(e,6,(function(e){return r.charAt(e)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),i._decompress(t.length,32,(function(n){return e(r,t.charAt(n))})))},compress:function(e){return i._compress(e,16,(function(e){return t(e)}))},_compress:function(e,t,n){if(null==e)return"";var r,o,i,s={},u={},c="",a="",p="",f=2,l=3,h=2,d=[],m=0,y=0;for(i=0;i<e.length;i+=1)if(c=e.charAt(i),Object.prototype.hasOwnProperty.call(s,c)||(s[c]=l++,u[c]=!0),a=p+c,Object.prototype.hasOwnProperty.call(s,a))p=a;else{if(Object.prototype.hasOwnProperty.call(u,p)){if(p.charCodeAt(0)<256){for(r=0;h>r;r++)m<<=1,y==t-1?(y=0,d.push(n(m)),m=0):y++;for(o=p.charCodeAt(0),r=0;8>r;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1}else{for(o=1,r=0;h>r;r++)m=m<<1|o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o=0;for(o=p.charCodeAt(0),r=0;16>r;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1}0==--f&&(f=Math.pow(2,h),h++),delete u[p]}else for(o=s[p],r=0;h>r;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1;0==--f&&(f=Math.pow(2,h),h++),s[a]=l++,p=String(c)}if(""!==p){if(Object.prototype.hasOwnProperty.call(u,p)){if(p.charCodeAt(0)<256){for(r=0;h>r;r++)m<<=1,y==t-1?(y=0,d.push(n(m)),m=0):y++;for(o=p.charCodeAt(0),r=0;8>r;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1}else{for(o=1,r=0;h>r;r++)m=m<<1|o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o=0;for(o=p.charCodeAt(0),r=0;16>r;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1}0==--f&&(f=Math.pow(2,h),h++),delete u[p]}else for(o=s[p],r=0;h>r;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1;0==--f&&(f=Math.pow(2,h),h++)}for(o=2,r=0;h>r;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1;for(;;){if(m<<=1,y==t-1){d.push(n(m));break}y++}return d.join("")},decompress:function(e){return null==e?"":""==e?null:i._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(e,n,r){var o,i,s,u,c,a,p,f=[],l=4,h=4,d=3,m="",y=[],v={val:r(0),position:n,index:1};for(o=0;3>o;o+=1)f[o]=o;for(s=0,c=Math.pow(2,2),a=1;a!=c;)u=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),s|=(u>0?1:0)*a,a<<=1;switch(s){case 0:for(s=0,c=Math.pow(2,8),a=1;a!=c;)u=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),s|=(u>0?1:0)*a,a<<=1;p=t(s);break;case 1:for(s=0,c=Math.pow(2,16),a=1;a!=c;)u=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),s|=(u>0?1:0)*a,a<<=1;p=t(s);break;case 2:return""}for(f[3]=p,i=p,y.push(p);;){if(v.index>e)return"";for(s=0,c=Math.pow(2,d),a=1;a!=c;)u=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),s|=(u>0?1:0)*a,a<<=1;switch(p=s){case 0:for(s=0,c=Math.pow(2,8),a=1;a!=c;)u=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),s|=(u>0?1:0)*a,a<<=1;f[h++]=t(s),p=h-1,l--;break;case 1:for(s=0,c=Math.pow(2,16),a=1;a!=c;)u=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=r(v.index++)),s|=(u>0?1:0)*a,a<<=1;f[h++]=t(s),p=h-1,l--;break;case 2:return y.join("")}if(0==l&&(l=Math.pow(2,d),d++),f[p])m=f[p];else{if(p!==h)return null;m=i+i.charAt(0)}y.push(m),f[h++]=i+m.charAt(0),i=m,0==--l&&(l=Math.pow(2,d),d++)}}};return i}();null!=e&&(e.exports=t)})),c=Phaser.Utils.Objects.GetFastValue,a=function(){function t(n){e(this,t),this.resetFromJSON(n)}return n(t,[{key:"resetFromJSON",value:function(e){return this.setEncoding(c(e,"encoding",0)),this}},{key:"toJSON",value:function(){return{encoding:this.encoding}}},{key:"setEncoding",value:function(e){return void 0===e?e=0:"string"==typeof e&&(e=p[e.toLowerCase()]||0),this.encoding=e,this}},{key:"compress",value:function(e){var t=f[this.encoding];return u[t](e)}},{key:"decompress",value:function(e){var t=l[this.encoding];return u[t](e)}}]),t}(),p={none:0,base64:1,utf16:2,uri:3},f=["compress","compressToBase64","compressToUTF16","compressToEncodedURIComponent"],l=["decompress","decompressFromBase64","decompressFromUTF16","decompressFromEncodedURIComponent"];return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(i,Phaser.Plugins.BasePlugin);var r=s(i);function i(t){var n;return e(this,i),(n=r.call(this,t)).lzstring=new a,n}return n(i,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"destroy",value:function(){this.lzstring=null,this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}},{key:"add",value:function(e){return new a(e)}}]),i}()}));
